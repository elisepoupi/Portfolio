# -*- coding: utf-8 -*-
#from builtins import ExceptionGroup
from flask import Flask, request, jsonify, render_template

import mlflow
import mlflow.lightgbm
import mlflow.sklearn
import os
import pandas as pd
import numpy as np
from numpy import NaN

app = Flask(__name__)

json_test_df_application={"SK_ID_CURR":170148,'NAME_CONTRACT_TYPE': 'Cash loans', 'CODE_GENDER': 'M', 'FLAG_OWN_CAR': 'N', 'FLAG_OWN_REALTY': 'Y', 'CNT_CHILDREN': 0, 'AMT_INCOME_TOTAL': 90000.0, 'AMT_CREDIT': 265500.0, 'AMT_ANNUITY': 21105.0, 'AMT_GOODS_PRICE': 265500.0, 'NAME_TYPE_SUITE': 'Unaccompanied', 'NAME_INCOME_TYPE': 'Working', 'NAME_EDUCATION_TYPE': 'Secondary / secondary special', 'NAME_FAMILY_STATUS': 'Civil marriage', 'NAME_HOUSING_TYPE': 'House / apartment', 'REGION_POPULATION_RELATIVE': 0.018209, 'DAYS_BIRTH': -15682, 'DAYS_EMPLOYED': -946, 'DAYS_REGISTRATION': -8170.0, 'DAYS_ID_PUBLISH': -3313, 'OWN_CAR_AGE': NaN, 'FLAG_MOBIL': 1, 'FLAG_EMP_PHONE': 1, 'FLAG_WORK_PHONE': 0, 'FLAG_CONT_MOBILE': 1, 'FLAG_PHONE': 0, 'FLAG_EMAIL': 0, 'OCCUPATION_TYPE': 'Drivers', 'CNT_FAM_MEMBERS': 2.0, 'REGION_RATING_CLIENT': 3, 'REGION_RATING_CLIENT_W_CITY': 3, 'WEEKDAY_APPR_PROCESS_START': 'FRIDAY', 'HOUR_APPR_PROCESS_START': 12, 'REG_REGION_NOT_LIVE_REGION': 0, 'REG_REGION_NOT_WORK_REGION': 0, 'LIVE_REGION_NOT_WORK_REGION': 0, 'REG_CITY_NOT_LIVE_CITY': 0, 'REG_CITY_NOT_WORK_CITY': 0, 'LIVE_CITY_NOT_WORK_CITY': 0, 'ORGANIZATION_TYPE': 'Business Entity Type 3', 'EXT_SOURCE_1': 0.2385889852546633, 'EXT_SOURCE_2': 0.1369069469883092, 'EXT_SOURCE_3': NaN, 'APARTMENTS_AVG': NaN, 'BASEMENTAREA_AVG': NaN, 'YEARS_BEGINEXPLUATATION_AVG': NaN, 'YEARS_BUILD_AVG': NaN, 'COMMONAREA_AVG': NaN, 'ELEVATORS_AVG': NaN, 'ENTRANCES_AVG': NaN, 'FLOORSMAX_AVG': NaN, 'FLOORSMIN_AVG': NaN, 'LANDAREA_AVG': NaN, 'LIVINGAPARTMENTS_AVG': NaN, 'LIVINGAREA_AVG': NaN, 'NONLIVINGAPARTMENTS_AVG': NaN, 'NONLIVINGAREA_AVG': NaN, 'APARTMENTS_MODE': NaN, 'BASEMENTAREA_MODE': NaN, 'YEARS_BEGINEXPLUATATION_MODE': NaN, 'YEARS_BUILD_MODE': NaN, 'COMMONAREA_MODE': NaN, 'ELEVATORS_MODE': NaN, 'ENTRANCES_MODE': NaN, 'FLOORSMAX_MODE': NaN, 'FLOORSMIN_MODE': NaN, 'LANDAREA_MODE': NaN, 'LIVINGAPARTMENTS_MODE': NaN, 'LIVINGAREA_MODE': NaN, 'NONLIVINGAPARTMENTS_MODE': NaN, 'NONLIVINGAREA_MODE': NaN, 'APARTMENTS_MEDI': NaN, 'BASEMENTAREA_MEDI': NaN, 'YEARS_BEGINEXPLUATATION_MEDI': NaN, 'YEARS_BUILD_MEDI': NaN, 'COMMONAREA_MEDI': NaN, 'ELEVATORS_MEDI': NaN, 'ENTRANCES_MEDI': NaN, 'FLOORSMAX_MEDI': NaN, 'FLOORSMIN_MEDI': NaN, 'LANDAREA_MEDI': NaN, 'LIVINGAPARTMENTS_MEDI': NaN, 'LIVINGAREA_MEDI': NaN, 'NONLIVINGAPARTMENTS_MEDI': NaN, 'NONLIVINGAREA_MEDI': NaN, 'FONDKAPREMONT_MODE': NaN, 'HOUSETYPE_MODE': NaN, 'TOTALAREA_MODE': NaN, 'WALLSMATERIAL_MODE': NaN, 'EMERGENCYSTATE_MODE': NaN, 'OBS_30_CNT_SOCIAL_CIRCLE': 4.0, 'DEF_30_CNT_SOCIAL_CIRCLE': 0.0, 'OBS_60_CNT_SOCIAL_CIRCLE': 4.0, 'DEF_60_CNT_SOCIAL_CIRCLE': 0.0, 'DAYS_LAST_PHONE_CHANGE': -596.0, 'FLAG_DOCUMENT_2': 0, 'FLAG_DOCUMENT_3': 1, 'FLAG_DOCUMENT_4': 0, 'FLAG_DOCUMENT_5': 0, 'FLAG_DOCUMENT_6': 0, 'FLAG_DOCUMENT_7': 0, 'FLAG_DOCUMENT_8': 0, 'FLAG_DOCUMENT_9': 0, 'FLAG_DOCUMENT_10': 0, 'FLAG_DOCUMENT_11': 0, 'FLAG_DOCUMENT_12': 0, 'FLAG_DOCUMENT_13': 0, 'FLAG_DOCUMENT_14': 0, 'FLAG_DOCUMENT_15': 0, 'FLAG_DOCUMENT_16': 0, 'FLAG_DOCUMENT_17': 0, 'FLAG_DOCUMENT_18': 0, 'FLAG_DOCUMENT_19': 0, 'FLAG_DOCUMENT_20': 0, 'FLAG_DOCUMENT_21': 0, 'AMT_REQ_CREDIT_BUREAU_HOUR': NaN, 'AMT_REQ_CREDIT_BUREAU_DAY': NaN, 'AMT_REQ_CREDIT_BUREAU_WEEK': NaN, 'AMT_REQ_CREDIT_BUREAU_MON': NaN, 'AMT_REQ_CREDIT_BUREAU_QRT': NaN, 'AMT_REQ_CREDIT_BUREAU_YEAR': NaN}  

json_test_df_complet={"CODE_GENDER":1.0,"FLAG_OWN_REALTY":0.0,"CNT_CHILDREN":0.0,"AMT_INCOME_TOTAL":180000.0,"AMT_CREDIT":135000.0,"AMT_ANNUITY":13482.0,"AMT_GOODS_PRICE":135000.0,"REGION_POPULATION_RELATIVE":0.01452,"DAYS_BIRTH":-20685.0,"DAYS_EMPLOYED":0.0,"DAYS_REGISTRATION":-9201.0,"DAYS_ID_PUBLISH":-4190.0,"FLAG_MOBIL":1.0,"FLAG_EMP_PHONE":0.0,"FLAG_WORK_PHONE":0.0,"FLAG_CONT_MOBILE":1.0,"FLAG_PHONE":0.0,"FLAG_EMAIL":0.0,"CNT_FAM_MEMBERS":2.0,"REGION_RATING_CLIENT":2.0,"REGION_RATING_CLIENT_W_CITY":2.0,"HOUR_APPR_PROCESS_START":12.0,"REG_REGION_NOT_LIVE_REGION":0.0,"REG_REGION_NOT_WORK_REGION":0.0,"LIVE_REGION_NOT_WORK_REGION":0.0,"REG_CITY_NOT_LIVE_CITY":0.0,"REG_CITY_NOT_WORK_CITY":0.0,"LIVE_CITY_NOT_WORK_CITY":0.0,"EXT_SOURCE_1":0.7149486683,"EXT_SOURCE_2":0.548699186,"EXT_SOURCE_3":0.4625618412,"APARTMENTS_AVG":0.0624,"BASEMENTAREA_AVG":0.0,"YEARS_BEGINEXPLUATATION_AVG":0.9831,"YEARS_BUILD_AVG":0.7348,"COMMONAREA_AVG":0.01995,"ELEVATORS_AVG":0.02,"ENTRANCES_AVG":0.1379,"FLOORSMAX_AVG":0.2221,"FLOORSMIN_AVG":0.375,"LANDAREA_AVG":0.0477,"LIVINGAPARTMENTS_AVG":0.0605,"LIVINGAREA_AVG":0.0673,"NONLIVINGAPARTMENTS_AVG":0.0,"NONLIVINGAREA_AVG":0.002,"APARTMENTS_MODE":0.0515,"BASEMENTAREA_MODE":0.0,"YEARS_BEGINEXPLUATATION_MODE":0.9786,"YEARS_BUILD_MODE":0.719,"COMMONAREA_MODE":0.01815,"ELEVATORS_MODE":0.0,"ENTRANCES_MODE":0.1379,"FLOORSMAX_MODE":0.1667,"FLOORSMIN_MODE":0.375,"LANDAREA_MODE":0.036,"LIVINGAPARTMENTS_MODE":0.0661,"LIVINGAREA_MODE":0.0622,"NONLIVINGAPARTMENTS_MODE":0.0,"NONLIVINGAREA_MODE":0.0,"APARTMENTS_MEDI":0.063,"BASEMENTAREA_MEDI":0.0,"YEARS_BEGINEXPLUATATION_MEDI":0.9826,"YEARS_BUILD_MEDI":0.7115,"COMMONAREA_MEDI":0.01965,"ELEVATORS_MEDI":0.0,"ENTRANCES_MEDI":0.1379,"FLOORSMAX_MEDI":0.1667,"FLOORSMIN_MEDI":0.375,"LANDAREA_MEDI":0.0486,"LIVINGAPARTMENTS_MEDI":0.0616,"LIVINGAREA_MEDI":0.0671,"NONLIVINGAPARTMENTS_MEDI":0.0,"NONLIVINGAREA_MEDI":0.002,"TOTALAREA_MODE":0.1791,"OBS_30_CNT_SOCIAL_CIRCLE":0.0,"DEF_30_CNT_SOCIAL_CIRCLE":0.0,"OBS_60_CNT_SOCIAL_CIRCLE":0.0,"DEF_60_CNT_SOCIAL_CIRCLE":0.0,"DAYS_LAST_PHONE_CHANGE":-1818.0,"FLAG_DOCUMENT_2":0.0,"FLAG_DOCUMENT_3":1.0,"FLAG_DOCUMENT_4":0.0,"FLAG_DOCUMENT_5":0.0,"FLAG_DOCUMENT_6":0.0,"FLAG_DOCUMENT_7":0.0,"FLAG_DOCUMENT_8":0.0,"FLAG_DOCUMENT_9":0.0,"FLAG_DOCUMENT_10":0.0,"FLAG_DOCUMENT_11":0.0,"FLAG_DOCUMENT_12":0.0,"FLAG_DOCUMENT_13":0.0,"FLAG_DOCUMENT_14":0.0,"FLAG_DOCUMENT_15":0.0,"FLAG_DOCUMENT_16":0.0,"FLAG_DOCUMENT_17":0.0,"FLAG_DOCUMENT_18":0.0,"FLAG_DOCUMENT_19":0.0,"FLAG_DOCUMENT_20":0.0,"FLAG_DOCUMENT_21":0.0,"AMT_REQ_CREDIT_BUREAU_HOUR":0.0,"AMT_REQ_CREDIT_BUREAU_DAY":0.0,"AMT_REQ_CREDIT_BUREAU_WEEK":0.0,"AMT_REQ_CREDIT_BUREAU_MON":0.0,"AMT_REQ_CREDIT_BUREAU_QRT":0.0,"AMT_REQ_CREDIT_BUREAU_YEAR":0.0,"OWN_CAR_COEFF":0.0,"NAME_CONTRACT_TYPE_Cashloans":1.0,"NAME_CONTRACT_TYPE_Revolvingloans":0.0,"NAME_TYPE_SUITE_Children":0.0,"NAME_TYPE_SUITE_Family":0.0,"NAME_TYPE_SUITE_Groupofpeople":0.0,"NAME_TYPE_SUITE_Other_A":0.0,"NAME_TYPE_SUITE_Other_B":0.0,"NAME_TYPE_SUITE_Spousepartner":0.0,"NAME_TYPE_SUITE_Unaccompanied":1.0,"NAME_INCOME_TYPE_Businessman":0.0,"NAME_INCOME_TYPE_Commercialassociate":0.0,"NAME_INCOME_TYPE_Maternityleave":0.0,"NAME_INCOME_TYPE_Pensioner":1.0,"NAME_INCOME_TYPE_Stateservant":0.0,"NAME_INCOME_TYPE_Student":0.0,"NAME_INCOME_TYPE_Unemployed":0.0,"NAME_INCOME_TYPE_Working":0.0,"NAME_EDUCATION_TYPE_Academicdegree":0.0,"NAME_EDUCATION_TYPE_Highereducation":0.0,"NAME_EDUCATION_TYPE_Incompletehigher":0.0,"NAME_EDUCATION_TYPE_Lowersecondary":0.0,"NAME_EDUCATION_TYPE_Secondarysecondaryspecial":1.0,"NAME_FAMILY_STATUS_Civilmarriage":0.0,"NAME_FAMILY_STATUS_Married":1.0,"NAME_FAMILY_STATUS_Separated":0.0,"NAME_FAMILY_STATUS_Singlenotmarried":0.0,"NAME_FAMILY_STATUS_Unknown":0.0,"NAME_FAMILY_STATUS_Widow":0.0,"NAME_HOUSING_TYPE_Coopapartment":0.0,"NAME_HOUSING_TYPE_Houseapartment":1.0,"NAME_HOUSING_TYPE_Municipalapartment":0.0,"NAME_HOUSING_TYPE_Officeapartment":0.0,"NAME_HOUSING_TYPE_Rentedapartment":0.0,"NAME_HOUSING_TYPE_Withparents":0.0,"OCCUPATION_TYPE_Accountants":0.0,"OCCUPATION_TYPE_Cleaningstaff":0.0,"OCCUPATION_TYPE_Cookingstaff":0.0,"OCCUPATION_TYPE_Corestaff":0.0,"OCCUPATION_TYPE_Drivers":0.0,"OCCUPATION_TYPE_HRstaff":0.0,"OCCUPATION_TYPE_Highskilltechstaff":0.0,"OCCUPATION_TYPE_ITstaff":0.0,"OCCUPATION_TYPE_Laborers":0.0,"OCCUPATION_TYPE_LowskillLaborers":0.0,"OCCUPATION_TYPE_Managers":0.0,"OCCUPATION_TYPE_Medicinestaff":0.0,"OCCUPATION_TYPE_Privateservicestaff":0.0,"OCCUPATION_TYPE_Realtyagents":0.0,"OCCUPATION_TYPE_Salesstaff":0.0,"OCCUPATION_TYPE_Secretaries":0.0,"OCCUPATION_TYPE_Securitystaff":0.0,"OCCUPATION_TYPE_Waitersbarmenstaff":0.0,"WEEKDAY_APPR_PROCESS_START_FRIDAY":0.0,"WEEKDAY_APPR_PROCESS_START_MONDAY":0.0,"WEEKDAY_APPR_PROCESS_START_SATURDAY":1.0,"WEEKDAY_APPR_PROCESS_START_SUNDAY":0.0,"WEEKDAY_APPR_PROCESS_START_THURSDAY":0.0,"WEEKDAY_APPR_PROCESS_START_TUESDAY":0.0,"WEEKDAY_APPR_PROCESS_START_WEDNESDAY":0.0,"ORGANIZATION_TYPE_Advertising":0.0,"ORGANIZATION_TYPE_Agriculture":0.0,"ORGANIZATION_TYPE_Bank":0.0,"ORGANIZATION_TYPE_BusinessEntityType1":0.0,"ORGANIZATION_TYPE_BusinessEntityType2":0.0,"ORGANIZATION_TYPE_BusinessEntityType3":0.0,"ORGANIZATION_TYPE_Cleaning":0.0,"ORGANIZATION_TYPE_Construction":0.0,"ORGANIZATION_TYPE_Culture":0.0,"ORGANIZATION_TYPE_Electricity":0.0,"ORGANIZATION_TYPE_Emergency":0.0,"ORGANIZATION_TYPE_Government":0.0,"ORGANIZATION_TYPE_Hotel":0.0,"ORGANIZATION_TYPE_Housing":0.0,"ORGANIZATION_TYPE_Industrytype1":0.0,"ORGANIZATION_TYPE_Industrytype10":0.0,"ORGANIZATION_TYPE_Industrytype11":0.0,"ORGANIZATION_TYPE_Industrytype12":0.0,"ORGANIZATION_TYPE_Industrytype13":0.0,"ORGANIZATION_TYPE_Industrytype2":0.0,"ORGANIZATION_TYPE_Industrytype3":0.0,"ORGANIZATION_TYPE_Industrytype4":0.0,"ORGANIZATION_TYPE_Industrytype5":0.0,"ORGANIZATION_TYPE_Industrytype6":0.0,"ORGANIZATION_TYPE_Industrytype7":0.0,"ORGANIZATION_TYPE_Industrytype8":0.0,"ORGANIZATION_TYPE_Industrytype9":0.0,"ORGANIZATION_TYPE_Insurance":0.0,"ORGANIZATION_TYPE_Kindergarten":0.0,"ORGANIZATION_TYPE_LegalServices":0.0,"ORGANIZATION_TYPE_Medicine":0.0,"ORGANIZATION_TYPE_Military":0.0,"ORGANIZATION_TYPE_Mobile":0.0,"ORGANIZATION_TYPE_Other":0.0,"ORGANIZATION_TYPE_Police":0.0,"ORGANIZATION_TYPE_Postal":0.0,"ORGANIZATION_TYPE_Realtor":0.0,"ORGANIZATION_TYPE_Religion":0.0,"ORGANIZATION_TYPE_Restaurant":0.0,"ORGANIZATION_TYPE_School":0.0,"ORGANIZATION_TYPE_Security":0.0,"ORGANIZATION_TYPE_SecurityMinistries":0.0,"ORGANIZATION_TYPE_Selfemployed":0.0,"ORGANIZATION_TYPE_Services":0.0,"ORGANIZATION_TYPE_Telecom":0.0,"ORGANIZATION_TYPE_Tradetype1":0.0,"ORGANIZATION_TYPE_Tradetype2":0.0,"ORGANIZATION_TYPE_Tradetype3":0.0,"ORGANIZATION_TYPE_Tradetype4":0.0,"ORGANIZATION_TYPE_Tradetype5":0.0,"ORGANIZATION_TYPE_Tradetype6":0.0,"ORGANIZATION_TYPE_Tradetype7":0.0,"ORGANIZATION_TYPE_Transporttype1":0.0,"ORGANIZATION_TYPE_Transporttype2":0.0,"ORGANIZATION_TYPE_Transporttype3":0.0,"ORGANIZATION_TYPE_Transporttype4":0.0,"ORGANIZATION_TYPE_University":0.0,"ORGANIZATION_TYPE_XNA":1.0,"FONDKAPREMONT_MODE_notspecified":0.0,"FONDKAPREMONT_MODE_orgspecaccount":0.0,"FONDKAPREMONT_MODE_regoperaccount":0.0,"FONDKAPREMONT_MODE_regoperspecaccount":0.0,"HOUSETYPE_MODE_blockofflats":1.0,"HOUSETYPE_MODE_specifichousing":0.0,"HOUSETYPE_MODE_terracedhouse":0.0,"WALLSMATERIAL_MODE_Block":0.0,"WALLSMATERIAL_MODE_Mixed":0.0,"WALLSMATERIAL_MODE_Monolithic":0.0,"WALLSMATERIAL_MODE_Others":0.0,"WALLSMATERIAL_MODE_Panel":1.0,"WALLSMATERIAL_MODE_Stonebrick":0.0,"WALLSMATERIAL_MODE_Wooden":0.0,"EMERGENCYSTATE_MODE_No":1.0,"EMERGENCYSTATE_MODE_Yes":0.0,"DAYS_EMPLOYED_PERC":0.0,"INCOME_CREDIT_PERC":0.75,"INCOME_PER_PERSON":90000.0,"ANNUITY_INCOME_PERC":0.0749,"PAYMENT_RATE":0.0998666667,"AMT_PERSO_CONTRIB":0.0,"BURO_DAYS_CREDIT_MIN":0.0,"BURO_DAYS_CREDIT_MAX":0.0,"BURO_DAYS_CREDIT_MEAN":0.0,"BURO_DAYS_CREDIT_VAR":0.0,"BURO_DAYS_CREDIT_ENDDATE_MIN":0.0,"BURO_DAYS_CREDIT_ENDDATE_MAX":0.0,"BURO_DAYS_CREDIT_ENDDATE_MEAN":0.0,"BURO_DAYS_CREDIT_UPDATE_MEAN":0.0,"BURO_CREDIT_DAY_OVERDUE_MAX":0.0,"BURO_CREDIT_DAY_OVERDUE_MEAN":0.0,"BURO_AMT_CREDIT_MAX_OVERDUE_MEAN":0.0,"BURO_AMT_CREDIT_SUM_MAX":0.0,"BURO_AMT_CREDIT_SUM_MEAN":0.0,"BURO_AMT_CREDIT_SUM_SUM":0.0,"BURO_AMT_CREDIT_SUM_DEBT_MAX":0.0,"BURO_AMT_CREDIT_SUM_DEBT_MEAN":0.0,"BURO_AMT_CREDIT_SUM_DEBT_SUM":0.0,"BURO_AMT_CREDIT_SUM_OVERDUE_MEAN":0.0,"BURO_AMT_CREDIT_SUM_LIMIT_MEAN":0.0,"BURO_AMT_CREDIT_SUM_LIMIT_SUM":0.0,"BURO_AMT_ANNUITY_MAX":0.0,"BURO_AMT_ANNUITY_MEAN":0.0,"BURO_CNT_CREDIT_PROLONG_SUM":0.0,"BURO_MONTHS_BALANCE_MIN_MIN":-24.0,"BURO_MONTHS_BALANCE_MAX_MAX":0.0,"BURO_MONTHS_BALANCE_SIZE_MEAN":14.175,"BURO_MONTHS_BALANCE_SIZE_SUM":0.0,"BURO_CREDIT_ACTIVE_Active_MEAN":0.0,"BURO_CREDIT_ACTIVE_Baddebt_MEAN":0.0,"BURO_CREDIT_ACTIVE_Closed_MEAN":0.0,"BURO_CREDIT_ACTIVE_Sold_MEAN":0.0,"BURO_CREDIT_CURRENCY_currency1_MEAN":0.0,"BURO_CREDIT_CURRENCY_currency2_MEAN":0.0,"BURO_CREDIT_CURRENCY_currency3_MEAN":0.0,"BURO_CREDIT_CURRENCY_currency4_MEAN":0.0,"BURO_CREDIT_TYPE_Anothertypeofloan_MEAN":0.0,"BURO_CREDIT_TYPE_Carloan_MEAN":0.0,"BURO_CREDIT_TYPE_Cashloannonearmarked_MEAN":0.0,"BURO_CREDIT_TYPE_Consumercredit_MEAN":0.0,"BURO_CREDIT_TYPE_Creditcard_MEAN":0.0,"BURO_CREDIT_TYPE_Loanforbusinessdevelopment_MEAN":0.0,"BURO_CREDIT_TYPE_Loanforpurchaseofsharesmarginlending_MEAN":0.0,"BURO_CREDIT_TYPE_Loanforthepurchaseofequipment_MEAN":0.0,"BURO_CREDIT_TYPE_Loanforworkingcapitalreplenishment_MEAN":0.0,"BURO_CREDIT_TYPE_Microloan_MEAN":0.0,"BURO_CREDIT_TYPE_Mobileoperatorloan_MEAN":0.0,"BURO_CREDIT_TYPE_Mortgage_MEAN":0.0,"BURO_CREDIT_TYPE_Realestateloan_MEAN":0.0,"BURO_CREDIT_TYPE_Unknowntypeofloan_MEAN":0.0,"BURO_STATUS_0_MEAN_MEAN":0.0,"BURO_STATUS_1_MEAN_MEAN":0.0,"BURO_STATUS_2_MEAN_MEAN":0.0,"BURO_STATUS_3_MEAN_MEAN":0.0,"BURO_STATUS_4_MEAN_MEAN":0.0,"BURO_STATUS_5_MEAN_MEAN":0.0,"BURO_STATUS_C_MEAN_MEAN":0.0,"BURO_STATUS_X_MEAN_MEAN":0.0,"ACTIVE_DAYS_CREDIT_MIN":0.0,"ACTIVE_DAYS_CREDIT_MAX":0.0,"ACTIVE_DAYS_CREDIT_MEAN":0.0,"ACTIVE_DAYS_CREDIT_VAR":0.0,"ACTIVE_DAYS_CREDIT_ENDDATE_MIN":0.0,"ACTIVE_DAYS_CREDIT_ENDDATE_MAX":0.0,"ACTIVE_DAYS_CREDIT_ENDDATE_MEAN":0.0,"ACTIVE_DAYS_CREDIT_UPDATE_MEAN":0.0,"ACTIVE_CREDIT_DAY_OVERDUE_MAX":0.0,"ACTIVE_CREDIT_DAY_OVERDUE_MEAN":0.0,"ACTIVE_AMT_CREDIT_MAX_OVERDUE_MEAN":0.0,"ACTIVE_AMT_CREDIT_SUM_MAX":0.0,"ACTIVE_AMT_CREDIT_SUM_MEAN":0.0,"ACTIVE_AMT_CREDIT_SUM_SUM":0.0,"ACTIVE_AMT_CREDIT_SUM_DEBT_MAX":0.0,"ACTIVE_AMT_CREDIT_SUM_DEBT_MEAN":0.0,"ACTIVE_AMT_CREDIT_SUM_DEBT_SUM":0.0,"ACTIVE_AMT_CREDIT_SUM_OVERDUE_MEAN":0.0,"ACTIVE_AMT_CREDIT_SUM_LIMIT_MEAN":0.0,"ACTIVE_AMT_CREDIT_SUM_LIMIT_SUM":0.0,"ACTIVE_AMT_ANNUITY_MAX":0.0,"ACTIVE_AMT_ANNUITY_MEAN":0.0,"ACTIVE_CNT_CREDIT_PROLONG_SUM":0.0,"ACTIVE_MONTHS_BALANCE_MIN_MIN":-19.0,"ACTIVE_MONTHS_BALANCE_MAX_MAX":0.0,"ACTIVE_MONTHS_BALANCE_SIZE_MEAN":12.5833333333,"ACTIVE_MONTHS_BALANCE_SIZE_SUM":0.0,"CLOSED_DAYS_CREDIT_MIN":0.0,"CLOSED_DAYS_CREDIT_MAX":0.0,"CLOSED_DAYS_CREDIT_MEAN":0.0,"CLOSED_DAYS_CREDIT_VAR":0.0,"CLOSED_DAYS_CREDIT_ENDDATE_MIN":0.0,"CLOSED_DAYS_CREDIT_ENDDATE_MAX":0.0,"CLOSED_DAYS_CREDIT_ENDDATE_MEAN":0.0,"CLOSED_DAYS_CREDIT_UPDATE_MEAN":2622.0,"CLOSED_CREDIT_DAY_OVERDUE_MAX":0.0,"CLOSED_CREDIT_DAY_OVERDUE_MEAN":0.0,"CLOSED_AMT_CREDIT_MAX_OVERDUE_MEAN":0.0,"CLOSED_AMT_CREDIT_SUM_MAX":0.0,"CLOSED_AMT_CREDIT_SUM_MEAN":0.0,"CLOSED_AMT_CREDIT_SUM_SUM":0.0,"CLOSED_AMT_CREDIT_SUM_DEBT_MAX":0.0,"CLOSED_AMT_CREDIT_SUM_DEBT_MEAN":0.0,"CLOSED_AMT_CREDIT_SUM_DEBT_SUM":0.0,"CLOSED_AMT_CREDIT_SUM_OVERDUE_MEAN":0.0,"CLOSED_AMT_CREDIT_SUM_LIMIT_MEAN":0.0,"CLOSED_AMT_CREDIT_SUM_LIMIT_SUM":0.0,"CLOSED_AMT_ANNUITY_MAX":0.0,"CLOSED_AMT_ANNUITY_MEAN":0.0,"CLOSED_CNT_CREDIT_PROLONG_SUM":0.0,"CLOSED_MONTHS_BALANCE_MIN_MIN":-29.0,"CLOSED_MONTHS_BALANCE_MAX_MAX":0.0,"CLOSED_MONTHS_BALANCE_SIZE_MEAN":20.5,"CLOSED_MONTHS_BALANCE_SIZE_SUM":0.0,"PREV_AMT_ANNUITY_MIN":-297098.595,"PREV_AMT_ANNUITY_MAX":-395558.145,"PREV_AMT_ANNUITY_MEAN":-288669.5325,"PREV_AMT_APPLICATION_MIN":-4050000.0,"PREV_AMT_APPLICATION_MAX":-6365160.0,"PREV_AMT_APPLICATION_MEAN":-3927331.7999999998,"PREV_AMT_CREDIT_MIN":-4019823.0,"PREV_AMT_CREDIT_MAX":646920.0,"PREV_AMT_CREDIT_MEAN":-3868400.25,"PREV_APP_CREDIT_PERC_MIN":-10.0,"PREV_APP_CREDIT_PERC_MAX":-18.8980017894,"PREV_APP_CREDIT_PERC_MEAN":-9.1382160049,"PREV_APP_CREDIT_PERC_VAR":-63.6026031714,"PREV_AMT_DOWN_PAYMENT_MIN":0.0,"PREV_AMT_DOWN_PAYMENT_MAX":-3055545.0,"PREV_AMT_DOWN_PAYMENT_MEAN":-1979212.5,"PREV_AMT_GOODS_PRICE_MIN":-4016745.0,"PREV_AMT_GOODS_PRICE_MAX":-6365160.0,"PREV_AMT_GOODS_PRICE_MEAN":-3882331.7999999998,"PREV_HOUR_APPR_PROCESS_START_MIN":6.0,"PREV_HOUR_APPR_PROCESS_START_MAX":16.0,"PREV_HOUR_APPR_PROCESS_START_MEAN":-12.3,"PREV_RATE_DOWN_PAYMENT_MIN":0.0,"PREV_RATE_DOWN_PAYMENT_MAX":-0.8586697497,"PREV_RATE_DOWN_PAYMENT_MEAN":-0.9560178687,"PREV_DAYS_DECISION_MIN":-2889.0,"PREV_DAYS_DECISION_MAX":-62.0,"PREV_DAYS_DECISION_MEAN":-1588.2,"PREV_CNT_PAYMENT_MEAN":15.6,"PREV_CNT_PAYMENT_SUM":156.0,"PREV_NAME_CONTRACT_TYPE_Cashloans_MEAN":0.4,"PREV_NAME_CONTRACT_TYPE_Consumerloans_MEAN":-0.5,"PREV_NAME_CONTRACT_TYPE_Revolvingloans_MEAN":0.1,"PREV_NAME_CONTRACT_TYPE_XNA_MEAN":0.0,"PREV_WEEKDAY_APPR_PROCESS_START_FRIDAY_MEAN":0.0,"PREV_WEEKDAY_APPR_PROCESS_START_MONDAY_MEAN":0.2,"PREV_WEEKDAY_APPR_PROCESS_START_SATURDAY_MEAN":0.2,"PREV_WEEKDAY_APPR_PROCESS_START_SUNDAY_MEAN":0.4,"PREV_WEEKDAY_APPR_PROCESS_START_THURSDAY_MEAN":0.0,"PREV_WEEKDAY_APPR_PROCESS_START_TUESDAY_MEAN":0.1,"PREV_WEEKDAY_APPR_PROCESS_START_WEDNESDAY_MEAN":0.1,"PREV_FLAG_LAST_APPL_PER_CONTRACT_N_MEAN":0.0,"PREV_FLAG_LAST_APPL_PER_CONTRACT_Y_MEAN":1.0,"PREV_NAME_CASH_LOAN_PURPOSE_Buildingahouseoranannex_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Businessdevelopment_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Buyingagarage_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Buyingaholidayhomeland_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Buyingahome_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Buyinganewcar_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Buyingausedcar_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Carrepairs_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Education_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Everydayexpenses_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Furniture_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Gasificationwatersupply_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Hobby_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Journey_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Medicine_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Moneyforathirdperson_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Other_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Paymentsonotherloans_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Purchaseofelectronicequipment_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Refusaltonamethegoal_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Repairs_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Urgentneeds_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_Weddinggiftholiday_MEAN":0.0,"PREV_NAME_CASH_LOAN_PURPOSE_XAP_MEAN":-0.4,"PREV_NAME_CASH_LOAN_PURPOSE_XNA_MEAN":0.4,"PREV_NAME_CONTRACT_STATUS_Approved_MEAN":0.0,"PREV_NAME_CONTRACT_STATUS_Canceled_MEAN":0.0,"PREV_NAME_CONTRACT_STATUS_Refused_MEAN":0.0,"PREV_NAME_CONTRACT_STATUS_Unusedoffer_MEAN":0.0,"PREV_NAME_PAYMENT_TYPE_Cashthroughthebank_MEAN":-0.2,"PREV_NAME_PAYMENT_TYPE_Cashlessfromtheaccountoftheemployer_MEAN":0.0,"PREV_NAME_PAYMENT_TYPE_Noncashfromyouraccount_MEAN":0.0,"PREV_NAME_PAYMENT_TYPE_XNA_MEAN":0.2,"PREV_CODE_REJECT_REASON_CLIENT_MEAN":0.0,"PREV_CODE_REJECT_REASON_HC_MEAN":0.0,"PREV_CODE_REJECT_REASON_LIMIT_MEAN":0.0,"PREV_CODE_REJECT_REASON_SCO_MEAN":0.0,"PREV_CODE_REJECT_REASON_SCOFR_MEAN":0.0,"PREV_CODE_REJECT_REASON_SYSTEM_MEAN":0.0,"PREV_CODE_REJECT_REASON_VERIF_MEAN":0.0,"PREV_CODE_REJECT_REASON_XAP_MEAN":1.0,"PREV_CODE_REJECT_REASON_XNA_MEAN":0.0,"PREV_NAME_TYPE_SUITE_Children_MEAN":0.0,"PREV_NAME_TYPE_SUITE_Family_MEAN":0.1,"PREV_NAME_TYPE_SUITE_Groupofpeople_MEAN":0.0,"PREV_NAME_TYPE_SUITE_Other_A_MEAN":0.0,"PREV_NAME_TYPE_SUITE_Other_B_MEAN":0.1,"PREV_NAME_TYPE_SUITE_Spousepartner_MEAN":0.1,"PREV_NAME_TYPE_SUITE_Unaccompanied_MEAN":-0.6,"PREV_NAME_TYPE_SUITE_nan_MEAN":0.3,"PREV_NAME_CLIENT_TYPE_New_MEAN":0.0,"PREV_NAME_CLIENT_TYPE_Refreshed_MEAN":0.1,"PREV_NAME_CLIENT_TYPE_Repeater_MEAN":0.9,"PREV_NAME_CLIENT_TYPE_XNA_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_AdditionalService_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Animals_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_AudioVideo_MEAN":0.1,"PREV_NAME_GOODS_CATEGORY_AutoAccessories_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_ClothingandAccessories_MEAN":0.2,"PREV_NAME_GOODS_CATEGORY_Computers_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_ConstructionMaterials_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_ConsumerElectronics_MEAN":0.1,"PREV_NAME_GOODS_CATEGORY_DirectSales_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Education_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Fitness_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Furniture_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Gardening_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Homewares_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_HouseConstruction_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Insurance_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Jewelry_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_MedicalSupplies_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Medicine_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Mobile_MEAN":0.1,"PREV_NAME_GOODS_CATEGORY_OfficeAppliances_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Other_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_PhotoCinemaEquipment_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_SportandLeisure_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Tourism_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Vehicles_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_Weapon_MEAN":0.0,"PREV_NAME_GOODS_CATEGORY_XNA_MEAN":0.5,"PREV_NAME_PORTFOLIO_Cards_MEAN":0.1,"PREV_NAME_PORTFOLIO_Cars_MEAN":0.0,"PREV_NAME_PORTFOLIO_Cash_MEAN":0.4,"PREV_NAME_PORTFOLIO_POS_MEAN":0.5,"PREV_NAME_PORTFOLIO_XNA_MEAN":0.0,"PREV_NAME_PRODUCT_TYPE_XNA_MEAN":-0.5,"PREV_NAME_PRODUCT_TYPE_walkin_MEAN":0.0,"PREV_NAME_PRODUCT_TYPE_xsell_MEAN":-0.5,"PREV_CHANNEL_TYPE_APCashloan_MEAN":0.1,"PREV_CHANNEL_TYPE_Cardealer_MEAN":0.0,"PREV_CHANNEL_TYPE_Channelofcorporatesales_MEAN":0.0,"PREV_CHANNEL_TYPE_Contactcenter_MEAN":0.0,"PREV_CHANNEL_TYPE_Countrywide_MEAN":-0.6,"PREV_CHANNEL_TYPE_Creditandcashoffices_MEAN":0.2,"PREV_CHANNEL_TYPE_RegionalLocal_MEAN":0.1,"PREV_CHANNEL_TYPE_Stone_MEAN":0.2,"PREV_NAME_SELLER_INDUSTRY_Autotechnology_MEAN":0.0,"PREV_NAME_SELLER_INDUSTRY_Clothing_MEAN":0.2,"PREV_NAME_SELLER_INDUSTRY_Connectivity_MEAN":0.0,"PREV_NAME_SELLER_INDUSTRY_Construction_MEAN":0.0,"PREV_NAME_SELLER_INDUSTRY_Consumerelectronics_MEAN":-0.5,"PREV_NAME_SELLER_INDUSTRY_Furniture_MEAN":0.0,"PREV_NAME_SELLER_INDUSTRY_Industry_MEAN":0.0,"PREV_NAME_SELLER_INDUSTRY_Jewelry_MEAN":0.0,"PREV_NAME_SELLER_INDUSTRY_MLMpartners_MEAN":0.0,"PREV_NAME_SELLER_INDUSTRY_Tourism_MEAN":0.0,"PREV_NAME_SELLER_INDUSTRY_XNA_MEAN":0.3,"PREV_NAME_YIELD_GROUP_XNA_MEAN":0.1,"PREV_NAME_YIELD_GROUP_high_MEAN":0.3,"PREV_NAME_YIELD_GROUP_low_action_MEAN":0.1,"PREV_NAME_YIELD_GROUP_low_normal_MEAN":-0.8,"PREV_NAME_YIELD_GROUP_middle_MEAN":-0.7,"PREV_PRODUCT_COMBINATION_CardStreet_MEAN":0.0,"PREV_PRODUCT_COMBINATION_CardXSell_MEAN":0.1,"PREV_PRODUCT_COMBINATION_Cash_MEAN":0.0,"PREV_PRODUCT_COMBINATION_CashStreethigh_MEAN":0.0,"PREV_PRODUCT_COMBINATION_CashStreetlow_MEAN":0.0,"PREV_PRODUCT_COMBINATION_CashStreetmiddle_MEAN":0.1,"PREV_PRODUCT_COMBINATION_CashXSellhigh_MEAN":0.0,"PREV_PRODUCT_COMBINATION_CashXSelllow_MEAN":0.2,"PREV_PRODUCT_COMBINATION_CashXSellmiddle_MEAN":0.1,"PREV_PRODUCT_COMBINATION_POShouseholdwithinterest_MEAN":0.3,"PREV_PRODUCT_COMBINATION_POShouseholdwithoutinterest_MEAN":0.0,"PREV_PRODUCT_COMBINATION_POSindustrywithinterest_MEAN":0.1,"PREV_PRODUCT_COMBINATION_POSindustrywithoutinterest_MEAN":0.1,"PREV_PRODUCT_COMBINATION_POSmobilewithinterest_MEAN":0.0,"PREV_PRODUCT_COMBINATION_POSmobilewithoutinterest_MEAN":0.0,"PREV_PRODUCT_COMBINATION_POSotherwithinterest_MEAN":0.0,"PREV_PRODUCT_COMBINATION_POSotherswithoutinterest_MEAN":0.0,"PREV_PRODUCT_COMBINATION_nan_MEAN":0.0,"APPROVED_AMT_ANNUITY_MIN":-297098.595,"APPROVED_AMT_ANNUITY_MAX":-371368.665,"APPROVED_AMT_ANNUITY_MEAN":-288669.5325,"APPROVED_AMT_APPLICATION_MIN":0.0,"APPROVED_AMT_APPLICATION_MAX":-5310000.0,"APPROVED_AMT_APPLICATION_MEAN":-3927331.7999999998,"APPROVED_AMT_CREDIT_MIN":-4019823.0,"APPROVED_AMT_CREDIT_MAX":-3862768.5,"APPROVED_AMT_CREDIT_MEAN":-3868400.25,"APPROVED_APP_CREDIT_PERC_MIN":-10.0,"APPROVED_APP_CREDIT_PERC_MAX":-18.8980017894,"APPROVED_APP_CREDIT_PERC_MEAN":-9.1382160049,"APPROVED_APP_CREDIT_PERC_VAR":-95.0919709323,"APPROVED_AMT_DOWN_PAYMENT_MIN":0.0,"APPROVED_AMT_DOWN_PAYMENT_MAX":-3055545.0,"APPROVED_AMT_DOWN_PAYMENT_MEAN":-1979212.5,"APPROVED_AMT_GOODS_PRICE_MIN":-4016745.0,"APPROVED_AMT_GOODS_PRICE_MAX":-5310000.0,"APPROVED_AMT_GOODS_PRICE_MEAN":-3882331.7999999998,"APPROVED_HOUR_APPR_PROCESS_START_MIN":6.0,"APPROVED_HOUR_APPR_PROCESS_START_MAX":-7.0,"APPROVED_HOUR_APPR_PROCESS_START_MEAN":-12.3,"APPROVED_RATE_DOWN_PAYMENT_MIN":0.0,"APPROVED_RATE_DOWN_PAYMENT_MAX":-0.8586697497,"APPROVED_RATE_DOWN_PAYMENT_MEAN":-0.9560178687,"APPROVED_DAYS_DECISION_MIN":-2889.0,"APPROVED_DAYS_DECISION_MAX":-62.0,"APPROVED_DAYS_DECISION_MEAN":-1588.2,"APPROVED_CNT_PAYMENT_MEAN":15.6,"APPROVED_CNT_PAYMENT_SUM":-408.0,"REFUSED_AMT_ANNUITY_MIN":0.0,"REFUSED_AMT_ANNUITY_MAX":0.0,"REFUSED_AMT_ANNUITY_MEAN":0.0,"REFUSED_AMT_APPLICATION_MIN":0.0,"REFUSED_AMT_APPLICATION_MAX":0.0,"REFUSED_AMT_APPLICATION_MEAN":0.0,"REFUSED_AMT_CREDIT_MIN":0.0,"REFUSED_AMT_CREDIT_MAX":0.0,"REFUSED_AMT_CREDIT_MEAN":0.0,"REFUSED_APP_CREDIT_PERC_MIN":0.0,"REFUSED_APP_CREDIT_PERC_MAX":0.0,"REFUSED_APP_CREDIT_PERC_MEAN":0.0,"REFUSED_APP_CREDIT_PERC_VAR":0.0,"REFUSED_AMT_DOWN_PAYMENT_MIN":0.0,"REFUSED_AMT_DOWN_PAYMENT_MAX":0.0,"REFUSED_AMT_DOWN_PAYMENT_MEAN":0.0,"REFUSED_AMT_GOODS_PRICE_MIN":0.0,"REFUSED_AMT_GOODS_PRICE_MAX":0.0,"REFUSED_AMT_GOODS_PRICE_MEAN":0.0,"REFUSED_HOUR_APPR_PROCESS_START_MIN":0.0,"REFUSED_HOUR_APPR_PROCESS_START_MAX":0.0,"REFUSED_HOUR_APPR_PROCESS_START_MEAN":0.0,"REFUSED_RATE_DOWN_PAYMENT_MIN":0.0,"REFUSED_RATE_DOWN_PAYMENT_MAX":0.0,"REFUSED_RATE_DOWN_PAYMENT_MEAN":0.0,"REFUSED_DAYS_DECISION_MIN":-610.0,"REFUSED_DAYS_DECISION_MAX":-367.5,"REFUSED_DAYS_DECISION_MEAN":-514.375,"REFUSED_CNT_PAYMENT_MEAN":0.0,"REFUSED_CNT_PAYMENT_SUM":0.0,"POS_MONTHS_BALANCE_MAX":-1.0,"POS_MONTHS_BALANCE_MEAN":-51.5443037975,"POS_MONTHS_BALANCE_SIZE":79.0,"POS_SK_DPD_MAX":0.0,"POS_SK_DPD_MEAN":0.0,"POS_SK_DPD_DEF_MAX":0.0,"POS_SK_DPD_DEF_MEAN":0.0,"POS_NAME_CONTRACT_STATUS_Active_MEAN":-0.0632911392,"POS_NAME_CONTRACT_STATUS_Amortizeddebt_MEAN":0.0,"POS_NAME_CONTRACT_STATUS_Approved_MEAN":0.0,"POS_NAME_CONTRACT_STATUS_Canceled_MEAN":0.0,"POS_NAME_CONTRACT_STATUS_Completed_MEAN":0.0632911392,"POS_NAME_CONTRACT_STATUS_Demand_MEAN":0.0,"POS_NAME_CONTRACT_STATUS_Returnedtothestore_MEAN":0.0,"POS_NAME_CONTRACT_STATUS_Signed_MEAN":0.0,"POS_NAME_CONTRACT_STATUS_XNA_MEAN":0.0,"POS_COUNT":79.0,"INSTAL_NUM_INSTALMENT_VERSION_NUNIQUE":4.0,"INSTAL_DPD_MAX":0.0,"INSTAL_DPD_MEAN":0.0,"INSTAL_DPD_SUM":0.0,"INSTAL_DBD_MAX":73.0,"INSTAL_DBD_MEAN":-284.1917808219,"INSTAL_DBD_SUM":-8951.0,"INSTAL_PAYMENT_PERC_MAX":1.0,"INSTAL_PAYMENT_PERC_MEAN":0.9315068493,"INSTAL_PAYMENT_PERC_SUM":-194369.4603718123,"INSTAL_PAYMENT_PERC_VAR":0.0379056227,"INSTAL_PAYMENT_DIFF_MAX":13500.0,"INSTAL_PAYMENT_DIFF_MEAN":1071.3914383562,"INSTAL_PAYMENT_DIFF_SUM":156423.15,"INSTAL_PAYMENT_DIFF_VAR":9271214.9185944684,"INSTAL_AMT_INSTALMENT_MAX":-3189220.2000000002,"INSTAL_AMT_INSTALMENT_MEAN":-2487821.800993151,"INSTAL_AMT_INSTALMENT_SUM":-30031673.8500000015,"INSTAL_AMT_PAYMENT_MIN":-2504455.6500000004,"INSTAL_AMT_PAYMENT_MAX":-3189220.2000000002,"INSTAL_AMT_PAYMENT_MEAN":-2488893.1924315072,"INSTAL_AMT_PAYMENT_SUM":-30397597.245000001,"INSTAL_DAYS_ENTRY_PAYMENT_MAX":-8.0,"INSTAL_DAYS_ENTRY_PAYMENT_MEAN":-1174.7534246575,"INSTAL_DAYS_ENTRY_PAYMENT_SUM":-171514.0,"INSTAL_COUNT":146.0,"CC_MONTHS_BALANCE_MIN":-42.0,"CC_MONTHS_BALANCE_MAX":-1.0,"CC_MONTHS_BALANCE_MEAN":-21.5,"CC_MONTHS_BALANCE_SUM":-903.0,"CC_MONTHS_BALANCE_VAR":150.5,"CC_AMT_BALANCE_MIN":0.0,"CC_AMT_BALANCE_MAX":405171.855,"CC_AMT_BALANCE_MEAN":130573.3821428571,"CC_AMT_BALANCE_SUM":5484082.0499999998,"CC_AMT_BALANCE_VAR":23316500683.3626937866,"CC_AMT_CREDIT_LIMIT_ACTUAL_MIN":0.0,"CC_AMT_CREDIT_LIMIT_ACTUAL_MAX":450000.0,"CC_AMT_CREDIT_LIMIT_ACTUAL_MEAN":-1082142.8571428573,"CC_AMT_CREDIT_LIMIT_ACTUAL_SUM":-21982500.0,"CC_AMT_CREDIT_LIMIT_ACTUAL_VAR":-413930867912.5751953125,"CC_AMT_DRAWINGS_ATM_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_ATM_CURRENT_MAX":85500.0,"CC_AMT_DRAWINGS_ATM_CURRENT_MEAN":6642.8571428571,"CC_AMT_DRAWINGS_ATM_CURRENT_SUM":279000.0,"CC_AMT_DRAWINGS_ATM_CURRENT_VAR":355844947.7351916432,"CC_AMT_DRAWINGS_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_CURRENT_MAX":97582.5,"CC_AMT_DRAWINGS_CURRENT_MEAN":13223.28,"CC_AMT_DRAWINGS_CURRENT_SUM":555377.76,"CC_AMT_DRAWINGS_CURRENT_VAR":638602666.8548492193,"CC_AMT_DRAWINGS_OTHER_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_MAX":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_MEAN":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_SUM":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_VAR":0.0,"CC_AMT_DRAWINGS_POS_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_POS_CURRENT_MAX":69417.0,"CC_AMT_DRAWINGS_POS_CURRENT_MEAN":6580.4228571429,"CC_AMT_DRAWINGS_POS_CURRENT_SUM":276377.76,"CC_AMT_DRAWINGS_POS_CURRENT_VAR":276747325.3217477202,"CC_AMT_INST_MIN_REGULARITY_MIN":0.0,"CC_AMT_INST_MIN_REGULARITY_MAX":20326.635,"CC_AMT_INST_MIN_REGULARITY_MEAN":6953.1385714286,"CC_AMT_INST_MIN_REGULARITY_SUM":292031.82,"CC_AMT_INST_MIN_REGULARITY_VAR":63445696.473447904,"CC_AMT_PAYMENT_CURRENT_MIN":0.0,"CC_AMT_PAYMENT_CURRENT_MAX":414045.0,"CC_AMT_PAYMENT_CURRENT_MEAN":17634.2110714286,"CC_AMT_PAYMENT_CURRENT_SUM":-29332507.2300000004,"CC_AMT_PAYMENT_CURRENT_VAR":3992098700.8116574287,"CC_AMT_PAYMENT_TOTAL_CURRENT_MIN":0.0,"CC_AMT_PAYMENT_TOTAL_CURRENT_MAX":414045.0,"CC_AMT_PAYMENT_TOTAL_CURRENT_MEAN":17634.2110714286,"CC_AMT_PAYMENT_TOTAL_CURRENT_SUM":740636.865,"CC_AMT_PAYMENT_TOTAL_CURRENT_VAR":3992098700.8116574287,"CC_AMT_RECEIVABLE_PRINCIPAL_MIN":0.0,"CC_AMT_RECEIVABLE_PRINCIPAL_MAX":395786.97,"CC_AMT_RECEIVABLE_PRINCIPAL_MEAN":127102.0425,"CC_AMT_RECEIVABLE_PRINCIPAL_SUM":5338285.7850000001,"CC_AMT_RECEIVABLE_PRINCIPAL_VAR":22158546256.3804092407,"CC_AMT_RECIVABLE_MIN":0.0,"CC_AMT_RECIVABLE_MAX":405171.855,"CC_AMT_RECIVABLE_MEAN":130308.2496428571,"CC_AMT_RECIVABLE_SUM":5472946.4849999994,"CC_AMT_RECIVABLE_VAR":23309638510.9940795898,"CC_AMT_TOTAL_RECEIVABLE_MIN":0.0,"CC_AMT_TOTAL_RECEIVABLE_MAX":405171.855,"CC_AMT_TOTAL_RECEIVABLE_MEAN":130308.2496428571,"CC_AMT_TOTAL_RECEIVABLE_SUM":5472946.4849999994,"CC_AMT_TOTAL_RECEIVABLE_VAR":23309638510.9940795898,"CC_CNT_DRAWINGS_ATM_CURRENT_MIN":0.0,"CC_CNT_DRAWINGS_ATM_CURRENT_MAX":2.0,"CC_CNT_DRAWINGS_ATM_CURRENT_MEAN":0.1666666667,"CC_CNT_DRAWINGS_ATM_CURRENT_SUM":7.0,"CC_CNT_DRAWINGS_ATM_CURRENT_VAR":0.1910569106,"CC_CNT_DRAWINGS_CURRENT_MIN":0.0,"CC_CNT_DRAWINGS_CURRENT_MAX":10.0,"CC_CNT_DRAWINGS_CURRENT_MEAN":0.8333333333,"CC_CNT_DRAWINGS_CURRENT_SUM":35.0,"CC_CNT_DRAWINGS_CURRENT_VAR":3.1666666667,"CC_CNT_DRAWINGS_OTHER_CURRENT_MIN":0.0,"CC_CNT_DRAWINGS_OTHER_CURRENT_MAX":0.0,"CC_CNT_DRAWINGS_OTHER_CURRENT_MEAN":0.0,"CC_CNT_DRAWINGS_OTHER_CURRENT_SUM":0.0,"CC_CNT_DRAWINGS_OTHER_CURRENT_VAR":0.0,"CC_CNT_DRAWINGS_POS_CURRENT_MIN":0.0,"CC_CNT_DRAWINGS_POS_CURRENT_MAX":10.0,"CC_CNT_DRAWINGS_POS_CURRENT_MEAN":0.6666666667,"CC_CNT_DRAWINGS_POS_CURRENT_SUM":28.0,"CC_CNT_DRAWINGS_POS_CURRENT_VAR":3.0081300813,"CC_CNT_INSTALMENT_MATURE_CUM_MIN":0.0,"CC_CNT_INSTALMENT_MATURE_CUM_MAX":21.0,"CC_CNT_INSTALMENT_MATURE_CUM_MEAN":15.0,"CC_CNT_INSTALMENT_MATURE_CUM_SUM":-7494.0,"CC_CNT_INSTALMENT_MATURE_CUM_VAR":54.6341463415,"CC_SK_DPD_MIN":0.0,"CC_SK_DPD_MAX":0.0,"CC_SK_DPD_MEAN":0.0,"CC_SK_DPD_SUM":0.0,"CC_SK_DPD_VAR":0.0,"CC_SK_DPD_DEF_MIN":0.0,"CC_SK_DPD_DEF_MAX":0.0,"CC_SK_DPD_DEF_MEAN":0.0,"CC_SK_DPD_DEF_SUM":0.0,"CC_SK_DPD_DEF_VAR":0.0,"CC_NAME_CONTRACT_STATUS_Active_MIN":1.0,"CC_NAME_CONTRACT_STATUS_Active_MAX":1.0,"CC_NAME_CONTRACT_STATUS_Active_MEAN":1.0,"CC_NAME_CONTRACT_STATUS_Active_SUM":-136.0,"CC_NAME_CONTRACT_STATUS_Active_VAR":0.0,"CC_NAME_CONTRACT_STATUS_Approved_MAX":0.0,"CC_NAME_CONTRACT_STATUS_Approved_MEAN":0.0,"CC_NAME_CONTRACT_STATUS_Approved_SUM":0.0,"CC_NAME_CONTRACT_STATUS_Approved_VAR":0.0,"CC_NAME_CONTRACT_STATUS_Completed_MIN":0.0,"CC_NAME_CONTRACT_STATUS_Completed_MAX":0.0,"CC_NAME_CONTRACT_STATUS_Completed_MEAN":0.0,"CC_NAME_CONTRACT_STATUS_Completed_SUM":0.0,"CC_NAME_CONTRACT_STATUS_Completed_VAR":0.0,"CC_NAME_CONTRACT_STATUS_Demand_MIN":0.0,"CC_NAME_CONTRACT_STATUS_Demand_MAX":0.0,"CC_NAME_CONTRACT_STATUS_Demand_MEAN":0.0,"CC_NAME_CONTRACT_STATUS_Demand_SUM":0.0,"CC_NAME_CONTRACT_STATUS_Demand_VAR":0.0,"CC_NAME_CONTRACT_STATUS_Refused_MAX":0.0,"CC_NAME_CONTRACT_STATUS_Refused_MEAN":0.0,"CC_NAME_CONTRACT_STATUS_Refused_SUM":0.0,"CC_NAME_CONTRACT_STATUS_Refused_VAR":0.0,"CC_NAME_CONTRACT_STATUS_Sentproposal_MAX":0.0,"CC_NAME_CONTRACT_STATUS_Sentproposal_MEAN":0.0,"CC_NAME_CONTRACT_STATUS_Sentproposal_SUM":0.0,"CC_NAME_CONTRACT_STATUS_Sentproposal_VAR":0.0,"CC_NAME_CONTRACT_STATUS_Signed_MIN":0.0,"CC_NAME_CONTRACT_STATUS_Signed_MAX":0.0,"CC_NAME_CONTRACT_STATUS_Signed_MEAN":0.0,"CC_NAME_CONTRACT_STATUS_Signed_SUM":0.0,"CC_NAME_CONTRACT_STATUS_Signed_VAR":0.0,"CC_COUNT":42.0}

def test_score_df_complet():
    assert round(score_df_prepare(donnees_json=json_test_df_complet, no_modif=True),3)== 0.018

def score_df_prepare(donnees_json, no_modif=True):
    X=pd.DataFrame(pd.Series(donnees_json)).T
    if no_modif==True:
        target = os.path.join(app.static_folder, 'mlflow_model/')
    else:
        target = os.path.join(app.static_folder, 'mlflow_pipeline/')
    model=mlflow.lightgbm.load_model(target)
    score=model.predict_proba(X)[0][1]
    return score

@app.route("/")
def hello():
    return "Bienvenue sur l'API de Prêt à dépenser! Veuillez utiliser le dashboard pour accéder aux scoring.\nVous pouvez également faire appel aux endpoints suivants :\n/V1/test_application/ pour vérifier le modèle avec pipeline à partir d'un individu préenregistré\n/v1/test_df_complet/ pour vérifier le modèle simple à partir d'un individu pré-enregistré\n\nDans les deux cas vous recevrez un score calculé à partir de l'individu test."

@app.route("/v1/scoring/", methods=["POST"])
def scoring():
    if request.method == "POST":
        try:
            donnees_json = request.get_json(force=True)
            score=score_df_prepare(donnees_json, no_modif=True)
            return jsonify({"score":score})
        except Exception as e:
            print(e)
            return f"erreur : {e}"


@app.route("/v1/scoring_modif/", methods=["POST"])
def scoring_modif():
    if request.method == "POST":
        donnees_json = request.get_json(force=True)
        score=score_df_prepare(donnees_json, no_modif=False)
        return jsonify({"score":score})

@app.route("/v1/test_application/", methods=["GET"])
def essai_application():
    if request.method == "GET":
        score=score_df_prepare(json_test_df_application, no_modif=False)
        return jsonify({"score":score})

@app.route("/v1/test_df_complet/", methods=["GET"])
def essai_df_complet():
    if request.method == "GET":
        score=score_df_prepare(json_test_df_complet, no_modif=True)
        return jsonify({"score":score})

if __name__ == "__main__":
    app.run(debug=True)